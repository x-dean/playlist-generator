# =============================================================================
# PLAYLIST GENERATOR SIMPLE - CONFIGURATION
# =============================================================================
# Clean configuration for the "SingleAnalyzer" approach
# Last updated: 2025-01 for PostgreSQL-only architecture

# =============================================================================
# CORE SETTINGS
# =============================================================================

# Music library path (mount point for your music collection)
MUSIC_PATH=/music

# Analysis timeout in seconds (10 minutes default)
ANALYSIS_TIMEOUT=600

# =============================================================================
# SMART WORKER ALLOCATION
# =============================================================================

# Worker allocation strategy
ANALYSIS_WORKERS=auto                   # 'auto' = dynamic based on workload, or specific number (1-8)

# Memory allocation per worker (baseline for calculations)
BASE_MEMORY_PER_WORKER_GB=1.2          # Gets multiplied by workload factors (2x-4x for large files)

# Total RAM override (useful for containers/LXC with memory limits)
USER_OVERRIDE_TOTAL_RAM_GB=8           # Override system RAM detection (leave empty for auto-detect)

# Workload detection mode
WORKLOAD_DETECTION_MODE=auto           # 'auto' = adjust workers based on file sizes, 'fixed' = use base only

# =============================================================================
# FILE SIZE OPTIMIZATION THRESHOLDS
# =============================================================================

# Files below this size get basic analysis
OPTIMIZED_PIPELINE_MIN_SIZE_MB=5

# Files above this size get Essentia-only analysis (no MusiCNN)
OPTIMIZED_PIPELINE_MAX_SIZE_MB=200

# =============================================================================
# AUDIO PROCESSING SETTINGS
# =============================================================================

# Sample rate for analysis (22050 Hz = good balance of speed/quality)
OPTIMIZED_SAMPLE_RATE=22050

# Segment analysis for large files
SEGMENT_LENGTH=30                       # Seconds per segment
MAX_SEGMENTS=4                          # Maximum segments to analyze

# Analysis quality mode
PIPELINE_RESOURCE_MODE=balanced         # 'low', 'balanced', or 'high_accuracy'

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# Console and file logging (both enabled by default)
LOG_CONSOLE_ENABLED=true
LOG_FILE_ENABLED=true

# Log file rotation
LOG_FILE_SIZE_MB=50                     # Max size before rotation
LOG_MAX_FILES=5                         # Number of rotated logs to keep

# =============================================================================
# DATABASE - POSTGRESQL ONLY
# =============================================================================

# PostgreSQL connection (usually overridden by Docker environment)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=playlista
POSTGRES_USER=playlista
POSTGRES_PASSWORD=playlista_password

# Connection pooling
POSTGRES_MIN_CONNECTIONS=2
POSTGRES_MAX_CONNECTIONS=10

# =============================================================================
# CACHING
# =============================================================================

# Enable caching for performance
CACHE_ENABLED=true

# =============================================================================
# EXTERNAL APIs (OPTIONAL)
# =============================================================================

# MusicBrainz metadata enrichment
MUSICBRAINZ_ENABLED=false

# Last.fm API integration
LASTFM_ENABLED=false
LASTFM_API_KEY=                         # Add your API key if using Last.fm

# =============================================================================
# ADVANCED SETTINGS (RARELY CHANGED)
# =============================================================================

# MusiCNN model files (configured in Docker)
MUSICNN_MODEL_PATH=/app/models/msd-musicnn-1.pb
MUSICNN_JSON_PATH=/app/models/msd-musicnn-1.json

# =============================================================================
# DOCKER-SPECIFIC OVERRIDES
# =============================================================================
# These paths are fixed in Docker and don't need to be changed:
# - LOG_FILE=/app/logs/playlista.log (set in Dockerfile)
# - CACHE_DIR=/app/cache (set in Dockerfile)
# - Model paths in /app/models (mounted in docker-compose)
# - PostgreSQL settings (overridden by environment variables)